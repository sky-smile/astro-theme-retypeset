---
title: Windows10å­ç³»ç»Ÿ(WSL)ç¯å¢ƒéƒ¨ç½²
published: 2024-12-19
tags: ["Windows","WSL","Linux"]
lang: zh
abbrlink: wsl
---

# ä»€ä¹ˆæ˜¯WSLï¼Ÿ

Windows Linuxå­ç³»ç»Ÿï¼ˆ[WSL](https://docs.microsoft.com/en-us/windows/wsl/about)ï¼‰æ˜¯Windows 10ä¸­çš„ä¸€ç§ç¯å¢ƒï¼Œç”¨äºä»¥ç±»ä¼¼äº[LinuxContainers](https://wiki.ubuntu.com/LinuxContainers)çš„æ–¹å¼è¿è¡Œæœªä¿®æ”¹çš„LinuxäºŒè¿›åˆ¶æ–‡ä»¶ã€‚Windows Linuxå­ç³»ç»Ÿä½¿å¼€å‘äººå‘˜å¯ä»¥ç›´æ¥åœ¨æœªç»ä¿®æ”¹çš„Windowsä¸Šè¿è¡ŒGNU / Linuxç¯å¢ƒï¼ŒåŒ…æ‹¬å¤§å¤šæ•°å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ç”¨ç¨‹åºå’Œåº”ç”¨ç¨‹åºï¼Œè€Œä¸ä¼šå¢åŠ è™šæ‹Ÿæœºçš„å¼€é”€ï¼Œéšwindowå¯åŠ¨ï¼Œéšæ—¶å¯ç”¨ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥è®¿é—®Windowæ–‡ä»¶ï¼Œéå¸¸æ–¹ä¾¿ã€‚

# WSLå®‰è£…

> é¦–å…ˆå£°æ˜ç¯å¢ƒä¸º Windows10 1909  --18363.476

åœ¨å®‰è£…ç”¨äºWSLçš„ä»»ä½•Linuxå‘è¡Œç‰ˆä¹‹å‰ï¼Œå¿…é¡»ç¡®ä¿å¯ç”¨`é€‚ç”¨äºLinuxçš„Windowså­ç³»ç»Ÿ`å¯é€‰åŠŸèƒ½ï¼š

ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€PowerShellå¹¶è¿è¡Œï¼š

```powershell
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux
```

å‡ºç°æç¤ºæ—¶ï¼Œè¯·é‡æ–°å¯åŠ¨è®¡ç®—æœºã€‚

ä»`Microsoft Store`å®‰è£…ï¼Œæœ¬äººå®‰è£…çš„æ˜¯`Ubuntu 18.04 LTS`ã€‚ç„¶åé€‰æ‹©æ‚¨å–œæ¬¢çš„Linuxå‘è¡Œç‰ˆã€‚

å®‰è£…å®Œæˆåé¦–æ¬¡æ‰“å¼€ä¼šè¦æ±‚è®¾ç½®è´¦æˆ·å’Œå¯†ç ï¼Œè®¾ç½®å®Œæˆå³å¯ä½¿ç”¨ã€‚`æ³¨æ„ï¼šè´¦æˆ·å¥½åƒåªèƒ½å°å†™ã€‚`

![](https://s2.loli.net/2025/03/29/ZQ5eyoPhz2KqOLb.jpg)

# WSLé…ç½®

## è®¾ç½®ä»Windows Terminalæ‰“å¼€wslæ—¶è¿›å…¥Linuxç”¨æˆ·ä¸»ç›®å½•

å½“ç›´æ¥é€šè¿‡Windows Terminalçš„æ ‡é¢˜æ æ‰“å¼€wslæ—¶ï¼Œé»˜è®¤ä¼šè¿›å…¥windowsçš„ç”¨æˆ·ç›®å½•ï¼Œè€Œè¿™æ˜æ˜¾ä¸å±äºLinuxçš„ç›®å½•ç»“æ„ï¼Œæ— æ³•ä½¿ç”¨Linuxçš„è¯»å†™ç‰¹æ€§ã€‚

### è§£å†³æ–¹æ³•

**ç¡®å®š`commandline`**

åœ¨å¾®è½¯å•†åº—(Windows Store)ä¸­æ‰¾åˆ°ä½ å½“åˆå®‰è£…çš„Linuxå‘è¡Œç‰ˆï¼Œä»â€œç®€ä»‹->æ›´å¤šâ€ä¸­æ‰¾ä¸€ä¸‹å¯åŠ¨å‘½ä»¤ã€‚

ä¾‹å¦‚ï¼šUbuntu æ˜¯ `ubuntu`, Ubuntu18.04æ˜¯ `ubuntu1804`, Ubuntu20.04æ˜¯ `ubuntu2004`ã€‚

**æ‰“å¼€é…ç½®æ–‡ä»¶**

é€šè¿‡â€œè®¾ç½®â€ï¼Œæ‰“å¼€Windows Terminalçš„é…ç½®æ–‡ä»¶ã€‚

åœ¨é…ç½®æ–‡ä»¶çš„`profiles`->`list`ä¸­æ‰¾çš„ä½ çš„Linuxå‘è¡Œç‰ˆ,æ·»åŠ ä¸€è¡Œcommandlineï¼š

```json
"commandline": "ubuntu2004"
```

## é…ç½®sudoå…å¯†

å¤‡ä»½sudoæ–‡ä»¶

```bash
sudo cp /etc/sudoers sudoers20191128
```

æ³¨æ„ï¼Œæ­¤æ–‡ä»¶åªèƒ½ç”¨viç¼–è¾‘

å…ˆå°è¯•ä½¿ç”¨visudoç¼–è¾‘sudoers

```bash
sudo visudo
```

å¦‚æœä»¥ä¸ŠæŒ‡ä»¤å¤±è´¥åˆ™ä½¿ç”¨viæ‰“å¼€ç¼–è¾‘

```bash
sudo vi /etc/sudoers
```

 æ‰¾åˆ° `root ALL=(ALL:ALL) ALL`ï¼Œåœ¨ä¸‹è¾¹æ·»åŠ :

```bash
lijian ALL=(ALL:ALL) NOPASSWD: ALL
```

å¦‚æœè¦è®©æ‰€æœ‰sudoæŒ‡ä»¤å…å¯†ï¼Œä¿®æ”¹ï¼š

```bash
%sudo ALL=(ALL:ALL) NOPASSWD: ALL
```

**æ³¨æ„**ï¼šç”¨æˆ·ååæ˜¯`tab`ï¼Œä¸æ˜¯`ç©ºæ ¼`ã€‚

![](https://s2.loli.net/2025/03/29/O7hPsXwfRWKEiet.jpg)

é‡æ–°ç™»å½•æµ‹è¯•

```bash
sudo ls
```

å¦‚æœä¸æç¤ºè¾“å…¥å¯†ç åˆ™é…ç½®æˆåŠŸã€‚

### linux ubuntu-20.04 su root å‘½ä»¤ è®¤è¯å¤±è´¥

è§£å†³æ–¹å¼ï¼šæ›´æ–°å¯†ç å³å¯ã€‚

```bash
sky@LiJian:/mnt/c/Users/sky$ sudo passwd
New password:
Retype new password:
passwd: password updated successfully
sky@LiJian:/mnt/c/Users/sky$ su
Password:
root@LiJian:/mnt/c/Users/sky# su sky
sky@LiJian:/mnt/c/Users/sky$
```

## åˆ‡æ¢æº

é»˜è®¤æºé€Ÿåº¦ç¼“æ…¢ï¼Œåˆ‡æ¢åˆ°é˜¿é‡Œæºã€‚

é¦–å…ˆå°†åŸé…ç½®æ–‡ä»¶å¤‡ä»½

```bash
sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak
```

ä½¿ç”¨vimæ‰“å¼€ï¼ŒWSLç«Ÿç„¶è‡ªå¸¦vimï¼Œæœ‰ç‚¹æ„æ€ã€‚

```bash
sudo vim /etc/apt/sources.list
```

è¿™é‡Œæä¾›ğŸ‘‰[Ubuntu çš„è½¯ä»¶æºï¼Œ](https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/)è¯·è‡ªè¡Œæ›´æ”¹ã€‚

åœ¨vimä¸­è¾“å…¥å¦‚ä¸‹çš„æ§åˆ¶ä»£ç ï¼š

```vim
:%s/security.ubuntu/mirrors.aliyun/g
:%s/archive.ubuntu/mirrors.aliyun/g
```

ä¿å­˜å¹¶é€€å‡ºã€‚æ‰§è¡Œä»¥ä¸‹ä»£ç æ›´æ–°è½¯ä»¶åŒ…åˆ°æœ€æ–°çŠ¶æ€ã€‚

```bash
sudo apt-get update&&sudo apt-get upgrade -y
```

![](https://s2.loli.net/2025/03/29/g6jfNRSlM5Iis3Z.jpg)

## è§£å†³ä¸­æ–‡ä¹±ç é—®é¢˜

å®‰è£…ä¸­æ–‡è¯­è¨€åŒ…

```bash
sudo apt install language-pack-zh-hans language-pack-zh-hans-base
```

è¿è¡Œä¸‹è¿°ä»£ç ï¼Œç°åœ¨å¯ä»¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡äº†ã€‚

```bash
sudo apt install fonts-noto-cjk
```

ç„¶åï¼Œä¿®æ”¹`/etc/environment`ï¼ˆåœ¨æ–‡ä»¶çš„æœ«å°¾è¿½åŠ ï¼‰ï¼š

```vim
LANG="zh_CN.UTF-8"
LANGUAGE="zh_CN:zh:en_US:en"
```

å†ä¿®æ”¹`/var/lib/locales/supported.d/local`(æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å°±æ–°å»ºï¼ŒåŒæ ·åœ¨æœ«å°¾è¿½åŠ )ï¼š

```vim
en_US.UTF-8 UTF-8
zh_CN.UTF-8 UTF-8
zh_CN.GBK GBK
zh_CN GB2312
```

å¯¹äºä¸­æ–‡ä¹±ç æ˜¯ç©ºæ ¼çš„æƒ…å†µï¼Œå®‰è£…ä¸­æ–‡å­—ä½“è§£å†³ã€‚

```bash
sudo apt-get install fonts-droid-fallback ttf-wqy-zenhei ttf-wqy-microhei fonts-arphic-ukai fonts-arphic-uming
```

æœ€åï¼Œæ‰§è¡Œå‘½ä»¤ï¼š

```bash
sudo locale-gen
```

é—®é¢˜è§£å†³ï¼Œä¸­æ–‡æ˜¾ç¤ºæ­£å¸¸ã€‚

### ä¿®æ”¹é»˜è®¤è¯­è¨€ç¯å¢ƒä¸ºä¸­æ–‡ï¼ˆå¯é€‰ï¼‰

è®¾ç½®æœ¬åœ°åŒ–ç¯å¢ƒå˜é‡

```bash
echo "LANG=zh_CN.UTF-8" >> ~/.profile
```

![](https://s2.loli.net/2025/03/29/ZcCGkiEO67JWPz9.jpg)

## å®‰è£…manæ‰‹å†Œ

Ubuntué»˜è®¤æ˜¯æ²¡æœ‰å®Œå…¨å®‰è£…[manæ‰‹å†Œ](https://www.kernel.org/doc/man-pages/download.html)çš„

```bash
wget -c https://mirrors.edge.kernel.org/pub/linux/docs/man-pages/man-pages-5.04.tar.gz
tar xvzf man-pages-5.04.tar.gz
cd man-pages-5.04
sudo make install
mandb  #æ›´æ–°
```

ä¸ºäº†æ˜¾ç¤ºä¸­æ–‡æ‰‹å†Œï¼Œä¸‹è½½manpages-zhåŒ…ã€‚

å¯ä»¥ç›´æ¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£…

```bash
sudo apt-get install  manpages-zh
```

æŸ¥çœ‹manå®‰è£…è·¯å¾„

```bash
dpkg -L manpages-zh | less
```

åœ¨`~/.bashrc`ä¸­æ·»åŠ 

```bash
alias cman='man -M /usr/share/man/zh_CN'
```

```bash
source ~/.zshrc
```

æŸ¥çœ‹æ˜¯æ˜¯å¦æˆåŠŸã€‚

```bash
cman ls
```

![](https://s2.loli.net/2025/03/29/2k189MYD4mqRE7H.jpg)

# Remote - WSL æ’ä»¶

 [Remote - WSL](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-wsl)

å®‰è£…åå¯ä»¥ï¼š

- åœ¨WSLä¸­è½¬åˆ°ä»»ä½•æ–‡ä»¶å¤¹å¹¶é”®å…¥ï¼š `code .`å¯åŠ¨VS Codeã€‚
- æŒ‰`F1`ï¼Œè¾“å…¥`Remote-WSLï¼šNew Window`ï¼Œç„¶åæŒ‰Enterã€‚ä½¿ç”¨æ–‡ä»¶èœå•æ‰“å¼€æ‚¨çš„æ–‡ä»¶å¤¹ã€‚

![](https://s2.loli.net/2025/03/29/6VlPopI8YO5ae4n.jpg)

# å®‰è£…oh-my-zsh

## å®‰è£…

```bash
sudo apt-get install zsh
```

```bash
wget --no-check-certificate https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh
```

å®‰è£…Powerlineå­—ä½“

```bash
sudo apt-get install fonts-powerline
```

å°†é»˜è®¤çš„shellä»bashæ”¹ä¸ºzsh

```bash
chsh -s /bin/zsh
```

## æ›´æ”¹ä¸»é¢˜

[å®˜ç½‘ä¸»é¢˜](https://github.com/robbyrussell/oh-my-zsh/wiki/themes)

ä¸»é¢˜çš„è·¯å¾„åœ¨`~/.oh-my-zsh/themes`, ä½¿æŸä¸€ä¸»é¢˜ç”Ÿæ•ˆçš„æ–‡ä»¶ä¸º`~/.zshrc`æ–‡ä»¶

```bash
vim ~/.zshrc
```

ä¿®æ”¹`ZSH_THEME="ys"`

## æ’ä»¶

[ç›¸å…³æ’ä»¶](https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins)

### Git

é»˜è®¤å·²å¼€å¯

**ä½œç”¨**

å¯ä»¥ä½¿ç”¨å„ç§ `git` å‘½ä»¤ç¼©å†™ã€‚

### Z

`oh-my-zsh` å†…ç½®ç»„ä»¶ Z

**ä½œç”¨** ç›®å½•é—´å¿«é€Ÿè·³è½¬,ä¸ç”¨å†ä¸€ç›´ `cd` äº†

ä½¿ç”¨`Z`çš„ç¼©å†™ `z`

`cd` å‘½ä»¤è¿›å…¥  `/home/lijian/.oh-my-zsh/`æ–‡ä»¶å¤¹ï¼Œä¸‹ä¸€æ¬¡å†æƒ³è¿›å…¥ `.oh-my-zsh` æ–‡ä»¶å¤¹çš„æ—¶å€™,ç›´æ¥ `z .oh-my-zsh`å³å¯,æˆ–è€…åªè¾“å…¥ `.oh-my-zsh`æˆ–ä¸€éƒ¨åˆ†`.oh` éƒ½è¡Œ

åˆ é™¤æ— æ•ˆè·¯å¾„

```bash
z -x æ— æ•ˆè·¯å¾„
```

### zsh-autosuggestions

[å®˜ç½‘](https://github.com/zsh-users/zsh-autosuggestions)

**ä½œç”¨** æ•ˆç‡ç¥å™¨

è¾“å…¥å‘½ä»¤æ—¶ï¼Œä¼šç»™å‡ºå»ºè®®çš„å‘½ä»¤ï¼ˆç°è‰²éƒ¨åˆ†ï¼‰æŒ‰é”®ç›˜ â†’ è¡¥å…¨

å¦‚æœæ„Ÿè§‰ â†’ è¡¥å…¨ä¸æ–¹ä¾¿ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰è¡¥å…¨çš„å¿«æ·é”®ï¼Œ(è¾“å…¥`ï¼Œ`ä¼šæœ‰é—®é¢˜ï¼Œä¸æ¨è)

```bash
bindkey ',' autosuggest-accept
```

åœ¨ `.zshrc` æ–‡ä»¶æ·»åŠ è¿™å¥è¯å³å¯ã€‚

ğŸ“–[å‚è€ƒ1](https://www.sunzhongwei.com/mip/modify-the-wsl-ubuntu-1804-default-source-for-ali-cloud-images)ï¼Œ[å‚è€ƒ2](https://juejin.im/entry/5ae00e54f265da0b8635ea5c)ï¼Œ[å‚è€ƒ3](https://wu-kan.github.io/posts/linux/Windows-Subsystem-for-Linux)

------
