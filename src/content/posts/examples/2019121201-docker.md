---
title: Dockerå®‰è£…æŒ‡å—
published: 2024-12-19
tags: ["Docker"]
lang: zh
abbrlink: docker02

---

# å®‰è£…Docker

> Ubuntu19.10

æœ¬äººä½¿ç”¨repositoryå®‰è£…ã€‚

## è®¾ç½®å­˜å‚¨åº“

æ›´æ–°`apt`åŒ…ç´¢å¼•ï¼š

```bash
sudo apt update
```

å®‰è£…è½¯ä»¶åŒ…ä»¥å…è®¸`apt`é€šè¿‡HTTPSä½¿ç”¨å­˜å‚¨åº“ï¼š

```bash
sudo apt install \
  apt-transport-https \
  ca-certificates \
  curl \
  gnupg-agent \
  software-properties-common
```

## Docker-ce è½¯ä»¶æº

### Dockerçš„å®˜æ–¹æº

æ·»åŠ stableç‰ˆçš„repositoryï¼š

```bash
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
```

```bash
sudo add-apt-repository \
 "deb [arch=amd64] https://download.docker.com/linux/ubuntu \
 $(lsb_release -cs) \
 stable"
```

### ä¸­ç§‘å¤§çš„ Docker-ce æº

```bash
curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add -
```

```bash
sudo add-apt-repository \
 "deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu \
 $(lsb_release -cs) \
 stable"
```

### æ¸…åå¤§å­¦çš„ Docker-ce æº

```bash
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
```

```bash
sudo add-apt-repository \
   "deb [arch=amd64] https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu \
   $(lsb_release -cs) \
   stable"
```

## å®‰è£…

æ›´æ–°`apt`åŒ…ç´¢å¼•ã€‚

```bash
sudo apt update
sudo apt upgrade
```

å®‰è£…æœ€æ–°çš„Docker CEå’Œcontainerdï¼š

```bash
sudo apt install docker-ce docker-ce-cli containerd.io
```

éªŒè¯å®‰è£…æˆåŠŸï¼š

```bash
sudo docker run hello-world
```

dockeræœåŠ¡å¼€æœºå¯åŠ¨ï¼š

```bash
sudo systemctl enable docker.service
```

## å¸è½½Docker

å¸è½½Docker CEåŒ…ï¼š

```bash
sudo apt purge docker-ce
```

åˆ é™¤imagesã€containerså’Œvolumesï¼š

```bash
sudo rm -rf /var/lib/docker
```

# Docker ç”¨æˆ·ç»„

é¦–å…ˆæŸ¥çœ‹æ˜¯å¦å·²ç»å­˜åœ¨dockeråˆ†ç»„

```bash
sudo cat /etc/group | grep docker
```

å¦‚æœæ²¡æœ‰dockeråˆ†ç»„ï¼Œåˆ›å»ºdockeråˆ†ç»„

```bash
sudo groupadd -g 999 docker
```

> `-g 999`ä¸ºç»„IDï¼Œå¯ä»¥ä¸æŒ‡å®š

å°†ç”¨æˆ·æ·»åŠ åˆ°dockeråˆ†ç»„

```bash
sudo usermod -aG docker <username>
```

ä¿®æ”¹å®ˆæŠ¤è¿›ç¨‹ç»‘å®šçš„å¥—æ¥å­—çš„æƒé™ï¼Œèƒ½å¤Ÿè¢«dockeråˆ†ç»„è®¿é—®

```bash
sudo chmod a+rw /var/run/docker.sock
```

é‡å¯docker-daemonä»¥ä¾¿è®©æƒé™ç”Ÿæ•ˆ

```bash
sudo systemctl restart docker
```

ç¡®è®¤ä½ å¯ä»¥ç›´æ¥è¿è¡Œdockerå‘½ä»¤ï¼Œæ‰§è¡Œdockerå‘½ä»¤

```bash
docker info
```

# Docker Hub é•œåƒåŠ é€Ÿ

åˆ›å»ºæˆ–ä¿®æ”¹ `/etc/docker/daemon.json`ï¼š

> Docker Hub é•œåƒåŠ é€Ÿæºé€‰æ‹©æ·»åŠ å³å¯

```bash
mkdir -p /etc/docker
tee /etc/docker/daemon.json <<-'EOF'
{
    "registry-mirrors": [
        "https://<aliname>.mirror.aliyuncs.com",    #é˜¿é‡Œäº‘ éœ€ç™»å½•
        "https://docker.mirrors.ustc.edu.cn",     #ç§‘å¤§
        "https://registry.docker-cn.com",           #Dockerä¸­å›½å®˜æ–¹é•œåƒ
        "https://mirror.ccs.tencentyun.com",     #è…¾è®¯äº‘
        "https://hub-mirror.c.163.com",             #ç½‘æ˜“äº‘
        "https://dockerhub.azk8s.cn"             #Azureä¸­å›½é•œåƒ
    ]
}
EOF
systemctl daemon-reload
systemctl restart docker
```

# Portainer

Portaineræ˜¯ä¸€ä¸ªè½»é‡çº§çš„ç®¡ç†UIï¼Œå¯è®©æ‚¨è½»æ¾ç®¡ç†ä¸åŒçš„Dockerç¯å¢ƒï¼ˆDockerä¸»æœºæˆ–Swarmé›†ç¾¤ï¼‰ã€‚Portainerçš„æ„å›¾æ˜¯æ˜“äºéƒ¨ç½²å’Œä½¿ç”¨ã€‚å®ƒç”±ä¸€ä¸ªå¯ä»¥åœ¨ä»»ä½•Dockerå¼•æ“ä¸Šè¿è¡Œçš„å®¹å™¨ç»„æˆï¼ˆå¯ä»¥éƒ¨ç½²ä¸ºLinuxå®¹å™¨æˆ–Windowsæœ¬æœºå®¹å™¨ï¼Œä¹Ÿæ”¯æŒå…¶ä»–å¹³å°ï¼‰ã€‚ Portainerå…è®¸æ‚¨ç®¡ç†æ‰€æœ‰Dockerèµ„æºï¼ˆå®¹å™¨ï¼Œæ˜ åƒï¼Œå·ï¼Œç½‘ç»œç­‰ï¼‰ï¼å®ƒä¸ç‹¬ç«‹çš„Dockerå¼•æ“å’Œ Docker Swarmæ¨¡å¼å…¼å®¹ã€‚

## å®‰è£… Portainer

```bash
docker pull portainer/portainer
docker run -d --name portainer -p 9000:9000 -v /var/run/docker.sock:/var/run/docker.sock -v /Users/eastren/Documents/Docker/portainer_data:/data portainer/portainer
```

## Portaineræ±‰åŒ–ï¼ˆå¯é€‰ï¼‰

![](https://s2.loli.net/2025/03/29/M7oAhiuYqGabxpc.png)

ä¸‹è½½æ±‰åŒ–æ–‡ä»¶

- [Portainer-CN](https://dl.quchao.net/Soft/Portainer-CN.zip)

1. æ–°å»ºæ–‡ä»¶å¤¹å‘½åä¸º `public` ï¼ŒæŠŠ `Portainer-CN.zip` è§£å‹è‡³é‡Œé¢
2. æŠŠ`public` æ–‡ä»¶å¤¹ä¼ è¾“è‡³ç³»ç»Ÿæ ¹ç›®å½•
3. ç„¶åæŒ‰éœ€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ x86-64ç³»ç»Ÿä½¿ç”¨

```bash
docker volume create portainer_data
docker run -d --name portainer -p 9000:9000 -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data -v /public:/public portainer/portainer
```

> å¯ä»¥æ·»åŠ å‚æ•°`--restart=always` è®¾ç½®`Portainer`å¼€æœºè‡ªåŠ¨å¯åŠ¨

å¦‚æœåˆ›å»ºæ—¶æœªæŒ‡å®š `--restart=always` ,å¯é€šè¿‡ `docker update` å‘½ä»¤è®¾ç½®ï¼š

```bash
docker update --restart=always XXXX
```

ğŸ“–[å‚è€ƒ](https://docs.docker.com/install/linux/docker-ce/ubuntu/)ï¼Œ[Portaineræ±‰åŒ–](https://www.quchao.net/Portainer-CN.html)

------
